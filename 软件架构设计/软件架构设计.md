# 软件架构设计
## 定义
1. 软件或计算机系统的软件架构是该系统的一个(或多个)结构,而结构由软件元素、元素的外部可见属性及他们之间的关系组成
2. 软件架构为软件系统提供了一个结构、行为和属性的高级抽象，由构成系统元素的描述、这些元素的互相作用、指导元素集成的模式及这些模式的约束组成
3. 软件架构是指一个系统的基础组织，它具体体现在: 系统的构建。构件之间、构建与环境之间的关系，以及指导其设计和演化的原则上

## 架构模型
### 结构模型
- 这是一个最直观、最普遍的建模方式。这种方法以架构的组件、连接件和其他概念来刻画结构,并力图通过结构来反映系统的重要语义内容,包括系统的配置、约束、隐含的假设条件、风格、性质。

### 框架模型
- 框架模型与结构模型类似，但它不太侧重描述结构的细节而更侧重于整体的结构。框架模型主要以一些特殊的问题为目标建立只针对和适应该问题的结构

### 动态模型
- 动态模型是对结构或框架模型的补充，研究系统"大颗粒"的行为性质.

### 过程模型
- 过程模型研究构造系统的步骤和过程。因而结构是遵循某些过程脚本的结果

### 功能模型
- 该模型认为架构由一组功能构件按层次组成，且下层向上层提供服务


### 4+1 视图
1. 逻辑视图
    主要支持系统的功能需求,即系统提供给最终用户的服务.
    在逻辑视图中,系统分解成一系列的功能抽象,这些抽象主要来自问题领域.
    在面向对象技术中,通过抽象、封装和集成，可以用对象模型来代表逻辑视图，用类图来描述逻辑视图。
    逻辑视图中使用的风格为面向对象的风格,逻辑视图设计中要主要的主要问题是要保持一个单一的、内聚的对象模型贯穿整个系统
2. 开发试图(模块视图)
    主要侧重于软件模块的组织和管理.
3. 进程视图
    侧重于系统的运行特性,主要关注一些非功能性的需求
    进程视图强调: 并发性、分布性、系统继承性和容错能力
4. 物理视图
    考虑如何把软件映射到硬件上,它通常要考虑到解决系统拓扑结构、系统安装、通信的问题
5. 场景
    重要系统活动的抽象，它使四个视图有机的联系起来
    场景是最重要的需求抽象
    
逻辑视图和开发视图描述系统的静态结构。进程视图和物理视图描述系统的动态结构

## 软件质量属性
- 软件质量特性包括: **功能性、可靠性、易用性、效率、可维护性、可移植性**
- 功能性
    - 适合性
    - 准确性
    - 互操作性
    - 依从性
    - 安全性
- 可靠性
    - 成熟性
    - 容错性
    - 易恢复性
- 易用性
    - 易理解性
    - 易学性
    - 易操作性
- 效率
    - 时间特性
    - 资源特性
- 可维护性
    - 易分析性
    - 易改变性
    - 稳定性
    - 易测试性
- 可移植性
    - 适应性
    - 易安装性
    - 遵循性
    - 易替换性
    
    
## 软件架构风格
- 分类
1. 数据流风格
    批处理序列, 管道-过滤器
2. 调用/返回风格
    主程序-子程序。
    面向对象风格: 层次结构
3. 独立构件风格
    进程通信
    事件系统
4. 虚拟机风格
    解释器
    基于规则的系统
5. 仓库风格
    数据库系统
    超文本系统
    黑板系统
    
### 数据流风格
#### 批处理序列
- 批处理风格的每一步都是独立的,并且每一步都是顺序执行,数据传送在步与步之间作为整体
典型应用
1. 经典数据处理
2. 程序开发
3. windows bat 脚本

#### 管道和过滤器
- 每个构件都有一组输入和输出,构件读输入shu的数据流,经过内部处理然后产生输出流
特点
1. 是的软构件具有良好的隐蔽性和高内聚、低耦合的特点
2. 允许设计者将整个系统的输入/输出行为看成是多个过滤器的行为的简单合成
3. 支持软件重用. 只要提供适合在两个过滤器之间传送的数据，任何两个过滤器都可以被连接起来
4. 系统维护和增强系统性能简单.新的过滤器可以添加到现有系统中来,旧的可以被改进的过滤器替换
5. 允许对吞吐量,死锁等属性的分析
6. 支持并行执行.每个过滤器是作为一个单独的任务完成.
缺点
1. 导致进程成为批处理的结构.
2. 不适合处理交互的应用
3. 因为在数据传输上没有通用的标准,每个过滤器都增加了解析和合成数据的工作，导致系统性能下降,并增加了编写过滤器的复杂性


#### 对比
- 共同点:
    1. 把任务分成一系列固定顺序的计算单元,组件之间只通过数据传递交互
- 区别
    1. 批处理是全部的,搞潜伏性的,输入时可以随机存取,无合作性、无交互性、
        管道-过滤器时递增的,数据结果延迟小,输入时处理局部变化,有反馈、可交互.
    2. 批处理强调数据传输在步与步之间作为一个整体,管道-过滤器没有这个要求
    

### 调用/返回风格
- 指在系统中采用了调用与返回机制.利用调用-返回,实际上是一种分而治之的策略,主要思想**将一个复杂的大系统分解为一些子系统,以便降低复杂度,并且增加可修改性.**
  
#### 主程序/子程序
- 结构化开发时期的经典架构风格. 这种风格一般采用单线程控制,把问题划分为若干处理步骤,构件即为主程序和子程序。子程序通常可以合成为模块

#### 面向对象风格
- 这种风格建立在数据抽象和面向对象的基础上,数据的表示方法和他们的相应操作封装在一个抽象数据类型或对象中.
- 特征
    1. 对象负责维护其表示的完整性
    2. 对象的表示对其他对象而言时隐蔽的
- 优点
    1. 因为对象对其他隐藏的表示,所以可以改变一个对象的表示，而不影响其他的对象
    2. 设计者可将一些数据的存取操作问题分解成为一些交互的代理程序集合
- 问题
    1. 为了使一个对象和另一个对象通过过程调用等进行交互,必须知道对象的标识,只要一个对象的标识变了,就必须修改所有其他明确调用它的对象
    2. 必须修改所有显式调用它的其他对象,并消除由此带来的副作用
    
#### 层次结构风格
- 层次系统组织成一个层次结构,每一层为上层服务,并最为下层客户
- 这种风格支持基于可增加抽象层的设计
- 优点
    1. 支持基于抽象程度递增的系统设计,使设计者可以把一个复杂系统按递增的步骤进行分解
    2. 支持功能增强. 因为每一层至多和相邻的上下层交互,因此功能的改变最多影响相邻的上下层
    3. 支持重用。只要提供服务接口定义不变,同一层的不同实现可以交换使用.允许定义一组标准接口,不同的实现方式
    
- 缺点
    1. 并不是每个系统都可以很容易地划分为分层模式
    2. 很难找到一个合适的、正确的层次抽象方法

### 独立构件风格
- 独立构件风格强调系统中的每个构件都是相对独立的个体,他们之间不能直接通讯,以降低耦合度，提升灵活度

#### 进程通信架构风格
- 构件时独立的过程，连接件时消息传递.

#### 事件系统风格
- 基于事件的隐式调用风格的思想是构件不直接调用的一个过程,二十触发或广播一个或多个事件


#### 隐式调用的优缺点
- 优点
    1. 为软件重用提供了强大的支持. 当需要将一个构件加入现存系统中时,只需要将它注册到系统的事件中
    2. 为改进系统带来方便。当用一个构件代替另一个构件时，不会影响到其他构建的接口
- 缺点
    1. 构件放弃了对系统计算的控制.
        一个构件触发一个事件时，不能确定其他构建是否会影响它。即使知道了事件注册了那些构件的过程,它也不能保证这些过程被调用的顺序
        
    2. 数据交换问题
        有时数据可被一个事件传递,单另一些情况下,基于事件的系统必须依靠一个共享的仓库进行交互.全局性能和资源管理变成了问题
    3. 既然过程的语义必须依赖于被触发事件的上下文约束.关于正确性的推理存在问题
    


### 虚拟机风格
- 人为构建一个运行环境,在这个环境之上,可以解释与允许自定义的一些语言

#### 解释器
- 一个解释器通常包括完成解释工作的解释引擎
    1. 被解释的代码的存储区
    2. 记录解释引擎当前工作状态的数据结构
    3. 记录源代码被解释执行的进度的数据结构
- 典型例子: 专家系统

#### 规则为中心
- 基于规则的系统包括: 规则集、规则解释器、规则/数据选择器以及工作内存


### 数据库风格
- 数据库系统
    中央共享数据源，保存当前系统的数据状态
    多个独立处理元素，处理元素对数据元素进行操作
- 超文本系统
- 黑板风格
    适合解决复杂的非结构化的问题,能在求解过程中综合运用多种不同知识源,使得问题的表达\组织和丘节变得容易
    组成部分
        1. 知识源
            知识源中包含独立的、与应用程序相关的知识,知识源之间不直接进行通信，它们之间的交互只能通过黑板来完成
        2. 黑板数据结构
            黑板数据是按照与应用程序相关的层次来组织的解决问题的数据,知识源通过不断改变黑板数据来解决问题
        3. 控制
            控制完全由黑板的状态驱动,黑板状态的改变决定使用特定知识
            
            
## 两层及三层C/S架构风格
- C/S架构是基于资源不对等,且为实现共享而提出来的.
- 两层C/S结构为: 单一服务器且以局域网为中心,难以拓展到大型企业广域网或Internet
    问题
        - 服务器的负荷太重，难以管理大量的客户机,系统的性能容易变差
        - 数据安全性不好. 客户端程序可以直接访问数据库服务器,客户端计算机上的其他程序也可能访问数据库服务器

- 三层C/S结构
    三层C/S结构是将应用功能分成表示层、功能层、数据层
    - 表示层
        应用的用户接口部分,承担用户与应用间的对话功能
        用于检查用户的输入,并显示应用输出的数据
        检查的内容只限于数据的形式和取值范围,不包括有关业务本身的逻辑处理
    - 功能层
        相当于应用的本体,它是将具体的业务处理逻辑编入程序中.
        需要处理的数据从表示层或数据层获得.
        表示层和功能层之间的数据交换需要尽可能简洁
    - 数据层
        数据库管理系统.
        负责管理对数据库的读写,

## B/S 架构风格
浏览器/服务器
### 对比 C/S 架构
- B/S架构的不足
    1. B/S 架构缺乏对动态页面的支持能力,没有集成有效的数据库处理功能
    2. 采用B/S架构的应用系统,在数据查询等响应速度上低于C/S架构
    3. B/S架构的数据提交一般以页面为单位,数据的动态交互性不强,不利于在线事务处理(OLTP)应用
    
    
## MVC 架构风格
- Model View Controller 模型-视图-控制器
- 各个部分的分工与协助
    1. Model 是对应用状态和业务功能的封装
        model 接受controller的请求并完成相应的业务处理,在状态改变的时候想view发出相应的通知
    2. View shi